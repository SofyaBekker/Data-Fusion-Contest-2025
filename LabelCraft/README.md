# Data Fusion Contest 2025 - Задача 1 "Label Craft"

Участникам необходимо предсказать категорию товаров на основе полученных данных о названиях товаров и их описаний.


## Постановка задачи

В этом соревновании вам предстоит разработать алгоритм для автоматической категоризации товаров по их названию и атрибутам, даже в условиях неполной разметки.

Система категорий устроена в виде иерархического дерева (до 5 уровней вложенности), а данные о товарах поступают с множества торговых площадок, что создает ряд сложностей:

 - Разметка товаров неполная и неидеальная.
 - Атрибуты одних и тех же товаров могут отличаться на разных площадках или вовсе отсутствовать.
 - По мере расширения каталога могут появляться новые площадки и категории, которых не было раньше.

В этом соревновании мы предлагаем участникам попробовать свои силы в постановке максимально приближенной к реальной: 

 - Задача осложняется тем, что в обучающей выборке категории размечены только для половины товаров, а в тестовой выборке встретятся категории, к которым нет размеченных примеров.
 - При этом вам заранее предоставлен полный список возможных категорий – сможете ли вы учесть их все и точно отнести товары к нужным классам?
 - LLM (большие языковые модели) выглядят многообещающе для подобных задач – но действительно ли они помогут? Это отличный шанс проверить различные подходы!


Метрика соревнования — HDA (Hierarchical Discounted Accuracy):

$HDA = \frac{1}{N} \sum_{i=1}^N D(y_{i}, \hat{y}_{i} )$

```math
D(y_{i}, \hat{y}_{i} ) = \begin{cases}0 & \text{if $LCA (y_{i}, \hat{y}_{i})  = \emptyset$}\\  \text{$ e^{ - LevelDiff (y_{i}, \hat{y}_{i} ) } $} & \text{$else$}\end{cases}
```
```math
LevelDiff (y_{i}, \hat{y}_{i} ) = max(0, Level(y_{i}) - Level( LCA (y_{i}, \hat{y}_{i} ) ) )
```
Где:
$N \text{ — число товаров},$
$y_{i} \text{ — истинные значения категории товара i},$
$\hat{y}_{i} \text{ — предсказанные значения категории товара i},$
$Level(y_{i} ) \text{ — уровень класса категории в дереве категорий},$
$LCA(y_{i}, y_{j} ) \text{ — наименьший общий предок между двумя категориями}.$

Метрика учитывает структуру категорий:

 - Если решение ошиблось только в последнем уровне категоризации товара, это считает “полу”-ошибкой. Значит вместо 1 балла ваше решение получит 1/exp(1) ≈ 0.37 балла. 
 - Оценка экспоненциально снижается в зависимости от разности уровня наиболее глубокой корректно предсказанной категории и уровня корректной категории. Для ошибки в 2 уровня вы будете получать уже 1/exp(2) ≈ 0.13 балла.
 - Если товар имеет разметку до 4 уровня, а ваш алгоритм предсказывает 5-й, оценка идет по 4-му уровню.
